<html lang="en">
<head>
    <script src="https://secure.aadcdn.microsoftonline-p.com/lib/1.0.0/js/msal.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@microsoft/microsoft-graph-client/lib/graph-js-sdk.js"></script>
</head>
<body>
    <button id="SignIn" onclick="init()">Sign In</button>
    <pre id="json"></pre>
    <script>

        async function init() {
            const msalConfig = {
                auth: {
                    clientId: "a974dfa0-9f57-49b9-95db-90f04ce2111a"
                },
            };
            const graphScopes = ["user.read"]; // An array of graph scopes

            const msalApplication = new Msal.UserAgentApplication(msalConfig);
            const options = new MicrosoftGraph.MSALAuthenticationProviderOptions(graphScopes);
            const authProvider = new MicrosoftGraph.ImplicitMSALAuthenticationProvider(msalApplication, options);

            const clientOptions = {
                authProvider, // An instance created from previous step
            };
            const Client = MicrosoftGraph.Client;
            const client = Client.initWithMiddleware(clientOptions);

            try {
                let userDetails = await client.api("/me").get();
                document.getElementById("json").innerHTML = JSON.stringify(userDetails, null, 2);
            } catch (error) {
                throw error;
            }
        }
    </script>
</body>
</html>